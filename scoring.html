<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Examiner - ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏ô‡∏µ‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏î‡∏¢ ‡∏û‡πà‡∏≠‡πÇ‡∏ô‡πÄ‡∏ö‡∏•</title>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <style>
        :root { --bg: #1a1a1a; --card: #2d2d30; --accent: #007acc; --success: #28a745; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: var(--bg); color: white; margin: 0; display: flex; flex-direction: column; align-items: center; min-height: 100vh; }
        
        /* Header & Credit */
        header { width: 100%; padding: 20px 0; text-align: center; background: var(--card); border-bottom: 2px solid var(--accent); margin-bottom: 20px; }
        .credit { font-size: 1.2rem; font-weight: bold; color: #ffc107; text-shadow: 0 0 10px rgba(255,193,7,0.3); }
        
        .container { width: 95%; max-width: 600px; background: var(--card); padding: 20px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        
        /* Setup Phase */
        #setup-box { text-align: center; }
        input[type="number"], input[type="text"] { width: 80%; padding: 15px; border-radius: 10px; border: 1px solid #444; background: #1e1e1e; color: white; font-size: 20px; text-align: center; margin-bottom: 15px; }
        .btn-connect { width: 85%; padding: 15px; background: var(--accent); color: white; border: none; border-radius: 10px; font-weight: bold; font-size: 18px; cursor: pointer; }
        
        /* Result Phase */
        #result-box { display: none; text-align: center; }
        #received-img { width: 100%; background: white; border-radius: 10px; border: 3px solid #fff; margin: 15px 0; }
        .task-label { font-size: 1.5rem; background: #444; padding: 10px; border-radius: 8px; margin-bottom: 10px; }
        
        input#score-input { width: 60%; font-size: 30px; margin-top: 10px; border: 2px solid var(--success); }
        .btn-submit { width: 85%; padding: 15px; background: var(--success); color: white; border: none; border-radius: 10px; font-weight: bold; font-size: 18px; margin-top: 10px; cursor: pointer; }
        
        #status-msg { margin-top: 20px; color: #aaa; font-size: 14px; }
    </style>
</head>
<body>

    <header>
        <div class="credit">‚ú® ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏ô‡∏µ‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏î‡∏¢ ‡∏û‡πà‡∏≠‡πÇ‡∏ô‡πÄ‡∏ö‡∏• ‚ú®</div>
    </header>

    <div class="container">
        <div id="setup-box">
            <h2>‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ß‡∏≤‡∏î</h2>
            <input type="number" id="pc-id" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™ 6 ‡∏´‡∏•‡∏±‡∏Å" pattern="\d*">
            <button class="btn-connect" onclick="startConnect()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ üîó</button>
        </div>

        <div id="result-box">
            <div class="task-label" id="target-char">‡πÇ‡∏à‡∏ó‡∏¢‡πå: -</div>
            <img id="received-img" src="" alt="Drawing from Painter">
            <p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô (0-100)</p>
            <input type="number" id="score-input" placeholder="100" min="0" max="100">
            <button class="btn-submit" onclick="submitScore()">‡∏™‡πà‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Å‡∏•‡∏±‡∏ö üöÄ</button>
        </div>

        <div id="status-msg">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™...</div>
    </div>

    <script>
        const peer = new Peer({
            config: { 'iceServers': [{ 'urls': 'stun:stun.l.google.com:19302' }] }
        });
        
        let conn = null;

        function startConnect() {
            const id = document.getElementById('pc-id').value.toString().trim();
            if (id.length < 6) {
                alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö 6 ‡∏´‡∏•‡∏±‡∏Å‡∏Ñ‡∏£‡∏±‡∏ö");
                return;
            }

            document.getElementById('status-msg').innerText = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö ID: " + id + "...";
            
            // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
            conn = peer.connect(id);

            conn.on('open', () => {
                document.getElementById('setup-box').style.display = 'none';
                document.getElementById('result-box').style.display = 'none';
                document.getElementById('status-msg').innerText = "‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß ‚úÖ ‡∏£‡∏≠‡∏£‡∏±‡∏ö‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏à‡∏≤‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ß‡∏≤‡∏î...";
                document.getElementById('status-msg').style.color = "#4ade80";
            });

            // ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ß‡∏≤‡∏î
            conn.on('data', data => {
                if (data.img) {
                    document.getElementById('received-img').src = data.img;
                    document.getElementById('target-char').innerText = "‡πÇ‡∏à‡∏ó‡∏¢‡πå: " + (data.char || "‡∏ß‡∏≤‡∏î‡∏≠‡∏¥‡∏™‡∏£‡∏∞");
                    document.getElementById('result-box').style.display = 'block';
                    document.getElementById('status-msg').style.display = 'none';
                    
                    // ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏•‡∏á‡∏°‡∏≤‡∏ó‡∏µ‡πà‡∏£‡∏π‡∏õ (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠)
                    window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
                }
            });

            conn.on('error', err => {
                alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á");
                document.getElementById('status-msg').innerText = "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß";
            });
            
            conn.on('close', () => {
                alert("‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏´‡∏•‡∏∏‡∏î");
                location.reload(); // ‡∏£‡∏µ‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢
            });
        }

        function submitScore() {
            const scoreValue = document.getElementById('score-input').value;
            if (scoreValue === "") {
                alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á‡∏Ñ‡∏£‡∏±‡∏ö");
                return;
            }

            if (conn && conn.open) {
                conn.send({ score: scoreValue });
                alert("‡∏™‡πà‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô " + scoreValue + " ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!");
                
                // ‡∏•‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏£‡∏≠‡∏£‡∏±‡∏ö‡∏£‡∏π‡∏õ‡∏ñ‡∏±‡∏î‡πÑ‡∏õ
                document.getElementById('result-box').style.display = 'none';
                document.getElementById('status-msg').style.display = 'block';
                document.getElementById('status-msg').innerText = "‡∏™‡πà‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÅ‡∏•‡πâ‡∏ß ‚úÖ ‡∏£‡∏≠‡∏£‡∏±‡∏ö‡∏£‡∏π‡∏õ‡∏ñ‡∏±‡∏î‡πÑ‡∏õ...";
                document.getElementById('score-input').value = "";
            } else {
                alert("‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏´‡∏•‡∏∏‡∏î ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡πà‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÑ‡∏î‡πâ");
            }
        }
    </script>
</body>
</html>
