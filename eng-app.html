<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>‡∏™‡∏ß‡∏ô‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡∏´‡∏£‡∏£‡∏©‡∏≤ BY ‡∏û‡πà‡∏≠‡πÇ‡∏ô‡πÄ‡∏ö‡∏•</title>
    <style>
        :root { 
            --sky-top: #a1e3ff;
            --sky-bottom: #e0f7fa;
            --grass-top: #8bc34a;
            --grass-bottom: #558b2f;
            --water-drop: #4fc3f7;
        }
        
        * { box-sizing: border-box; touch-action: none; -webkit-tap-highlight-color: transparent; }
        
        body { 
            margin: 0; font-family: 'Segoe UI', Tahoma, sans-serif; background: #1a1a1a; 
            display: flex; justify-content: center; align-items: center; 
            height: 100dvh; overflow: hidden; 
        }

        #game-container {
            width: 100%; max-width: 480px; height: 100dvh;
            background: linear-gradient(to bottom, var(--sky-top) 0%, var(--sky-bottom) 50%, var(--grass-top) 50%, var(--grass-bottom) 100%);
            position: relative; overflow: hidden; display: flex; flex-direction: column;
            box-shadow: 0 0 50px rgba(0,0,0,0.5);
        }

        /* HUD */
        #hud {
            padding: 10px 15px; background: rgba(255, 255, 255, 0.2); 
            backdrop-filter: blur(10px); color: #2e7d32;
            display: flex; justify-content: space-between; font-weight: 800;
            z-index: 100; font-size: 14px; border-bottom: 1px solid rgba(255,255,255,0.3);
        }

        #garden-view { flex: 1.2; position: relative; width: 100%; }

        /* ‡∏Å‡πâ‡∏≠‡∏ô‡πÄ‡∏°‡∏Ü (‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤) */
        .cloud {
            position: absolute; background: white; border-radius: 50px;
            width: 80px; height: 30px; opacity: 0.8;
            animation: moveClouds 25s infinite linear; z-index: 1;
        }
        .cloud::before, .cloud::after { content: ''; position: absolute; background: white; border-radius: 50%; }
        .cloud::before { width: 40px; height: 40px; top: -15px; left: 10px; }
        .cloud::after { width: 30px; height: 30px; top: -10px; right: 10px; }
        @keyframes moveClouds { from { left: -100px; } to { left: 110%; } }

        /* ‡∏û‡∏£‡∏∞‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå (‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß) */
        .sun { 
            position: absolute; width: 60px; height: 60px; 
            background: radial-gradient(circle, #fff200, #ff9800); 
            border-radius: 50%; top: 30px; right: 30px; 
            box-shadow: 0 0 30px #ffeb3b; z-index: 1; 
            animation: sunPulse 4s infinite ease-in-out;
        }
        @keyframes sunPulse {
            0%, 100% { transform: scale(1); filter: brightness(1); }
            50% { transform: scale(1.1); filter: brightness(1.2); }
        }

        /* ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏•‡∏≤‡∏Å‡∏ß‡∏≤‡∏á */
        #match-side {
            flex: 1; background: rgba(255, 255, 255, 0.92);
            padding: 10px; border-top: 5px solid #4e342e;
            display: grid; grid-template-columns: 1fr 1fr; gap: 8px; 
            overflow-y: auto; z-index: 10;
        }

        /* ‡∏´‡∏¢‡∏î‡∏ô‡πâ‡∏≥ */
        .word-item {
            position: absolute; width: 65px; height: 85px;
            background: linear-gradient(135deg, #4fc3f7, #0288d1); 
            color: white; border-radius: 0 50% 50% 50%; 
            transform: rotate(45deg); cursor: grab; font-weight: bold; 
            border: 2px solid rgba(255,255,255,0.8);
            box-shadow: 0 5px 10px rgba(0,0,0,0.2); z-index: 50; 
            display: flex; align-items: center; justify-content: center;
        }
        .word-text { transform: rotate(-45deg); font-size: 11px; text-align: center; pointer-events: none; }

        .drop-zone {
            background: #fdfdfd; border: 2px solid #ddd; border-radius: 12px;
            padding: 5px; text-align: center; font-size: 15px; font-weight: bold; color: #333;
            display: flex; align-items: center; justify-content: center; height: 50px;
        }
        .drop-zone.matched { background: #81c784; color: white; border-color: transparent; }

        .controls { padding: 15px; background: #33691e; display: flex; justify-content: center; z-index: 100; position: relative; }
        button {
            padding: 12px 40px; font-size: 18px; cursor: pointer; border-radius: 25px;
            border: none; background: linear-gradient(to bottom, #ffa726, #fb8c00); 
            color: white; font-weight: bold; box-shadow: 0 4px 0 #e65100;
        }
        button:active { transform: translateY(2px); box-shadow: 0 2px 0 #e65100; }
        .home-btn { position: absolute; bottom: 5px; left: 10px; font-size: 10px; color: #fff; text-decoration: none; opacity: 0.8; }
        #credit { position: absolute; bottom: 5px; right: 10px; font-size: 10px; color: #fff; opacity: 0.8; }

        .animal { position: absolute; bottom: 10px; z-index: 10; font-size: 40px; transition: left 3.5s ease-in-out, transform 0.3s; user-select: none; pointer-events: none; }
        .garden-item { position: absolute; bottom: 0; z-index: 5; }
    </style>
</head>
<body>

<div id="game-container">
    <div id="hud">
        <span>üå≥ LV <span id="lvl">1</span></span>
        <span>üêæ <span id="count">1</span></span>
        <span>üçé PROGRESS <span id="score">0</span>/5</span>
    </div>

    <div id="garden-view">
        <div class="sun"></div>
        <div class="cloud" style="top: 40px; animation-duration: 30s;"></div>
        <div class="cloud" style="top: 80px; animation-duration: 45s; animation-delay: -10s;"></div>
        
        <div id="garden-items-layer">
            <svg id="main-tree" class="garden-item" style="left:50%; transform:translateX(-50%);" width="100" height="130" viewBox="0 0 100 100">
                <rect x="42" y="70" width="16" height="30" fill="#5D4037" />
                <circle cx="50" cy="45" r="35" fill="#2E7D32" />
            </svg>
        </div>
        <div id="words-container"></div>
        <div id="animal-layer"></div>
    </div>

    <div id="match-side"></div>

    <div class="controls">
        <a href="https://ratchakit-nbo.github.io/-nobelpainter-app/game-nobel.html" class="home-btn">üè† ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
        <button id="spawn-btn" onclick="spawnFiveWords()">üíß ‡∏£‡∏î‡∏ô‡πâ‡∏≥‡πÉ‡∏ô‡∏™‡∏ß‡∏ô</button>
        <div id="credit">BY-‡∏û‡πà‡∏≠‡πÇ‡∏ô‡πÄ‡∏ö‡∏•</div>
    </div>
</div>

<script>
    let score = 0, level = 1, activeWords = [];
    let animals = [{emoji: 'üê∂', pos: 50}];
    const animalList = ['üê∂', 'üê±', 'üê∞', 'ü¶ä', 'üêª', 'üêº', 'üê®', 'üêØ', 'ü¶Å', 'üê∑', 'üê∏', 'üêµ'];

    function playFullAudio(en, th) {
        window.speechSynthesis.cancel();
        const msgEn = new SpeechSynthesisUtterance(en);
        msgEn.lang = 'en-US'; msgEn.rate = 0.8;
        msgEn.onend = () => {
            if (th) {
                setTimeout(() => {
                    const msgTh = new SpeechSynthesisUtterance(th);
                    msgTh.lang = 'th-TH'; msgTh.rate = 0.9;
                    window.speechSynthesis.speak(msgTh);
                }, 100); 
            }
        };
        window.speechSynthesis.speak(msgEn);
    }

    async function spawnFiveWords() {
        if (activeWords.length > 0) return;
        const btn = document.getElementById('spawn-btn');
        btn.disabled = true; btn.innerText = "‚è≥ ‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà...";
        for (let i = 0; i < 5; i++) {
            await fetchWord();
            await new Promise(r => setTimeout(r, 200));
        }
        btn.disabled = false; btn.innerText = "üíß ‡∏£‡∏î‡∏ô‡πâ‡∏≥‡∏™‡∏ß‡∏ô";
    }

    async function fetchWord() {
        try {
            const res = await fetch('https://api.datamuse.com/words?rel_jja=beautiful&max=100');
            const data = await res.json();
            const filtered = data.filter(d => d.word.length > 2 && d.word.length < 8);
            let word = filtered[Math.floor(Math.random() * filtered.length)].word.toUpperCase();
            
            // ‡πÉ‡∏ä‡πâ Google Translate API (Free Bridge) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡∏ß‡πà‡∏≤‡∏á
            const transRes = await fetch(`https://translate.googleapis.com/translate_a/single?client=gtx&sl=en&tl=th&dt=t&q=${encodeURIComponent(word)}`);
            const transData = await transRes.json();
            let th = transData[0][0][0];

            if (th && th !== word) {
                createElements({ en: word, th: th, id: 'w' + Math.random().toString(36).substr(2, 5) });
            } else {
                await fetchWord(); // ‡∏ñ‡πâ‡∏≤‡πÅ‡∏õ‡∏•‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏´‡πâ‡∏™‡∏∏‡πà‡∏°‡πÉ‡∏´‡∏°‡πà
            }
        } catch (e) { console.log("API Error"); }
    }

    function createElements(obj) {
        activeWords.push(obj);
        const el = document.createElement('div');
        el.className = 'word-item'; el.id = obj.id;
        el.innerHTML = `<span class="word-text">${obj.en}</span>`;
        el.style.left = (Math.random() * 70 + 5) + '%'; el.style.top = '5%';
        document.getElementById('words-container').appendChild(el);
        
        el.addEventListener('touchstart', (e) => { 
            activeDrag = el; 
            const ut = new SpeechSynthesisUtterance(obj.en); ut.lang = 'en-US';
            window.speechSynthesis.speak(ut);
        }, {passive: false});
        el.addEventListener('touchmove', handleTouchMove, {passive: false});
        el.addEventListener('touchend', handleTouchEnd);

        const zone = document.createElement('div');
        zone.className = 'drop-zone'; zone.id = 'z' + obj.id; zone.innerText = obj.th;
        document.getElementById('match-side').appendChild(zone);

        setTimeout(() => { el.style.transition = "top 1.5s cubic-bezier(0.25, 0.46, 0.45, 0.94)"; el.style.top = '72%'; }, 50);
    }

    let activeDrag = null;
    function handleTouchMove(e) {
        if (!activeDrag) return;
        e.preventDefault();
        const touch = e.touches[0];
        activeDrag.style.transition = 'none';
        activeDrag.style.left = (touch.clientX - 32) + 'px';
        activeDrag.style.top = (touch.clientY - 42) + 'px';
        activeDrag.style.zIndex = 1000;
    }

    function handleTouchEnd(e) {
        if (!activeDrag) return;
        const rect = activeDrag.getBoundingClientRect();
        const zone = document.getElementById('z' + activeDrag.id);
        const zoneRect = zone.getBoundingClientRect();
        if (rect.left < zoneRect.right && rect.right > zoneRect.left && rect.top < zoneRect.bottom && rect.bottom > zoneRect.top) {
            const word = activeWords.find(w => w.id === activeDrag.id);
            zone.className = 'drop-zone matched'; zone.innerText = "‚úÖ " + word.en;
            playFullAudio(word.en, word.th);
            activeDrag.remove();
            activeWords = activeWords.filter(w => w.id !== activeDrag.id);
            score++; document.getElementById('score').innerText = score;
            if (score >= 5) setTimeout(levelUp, 1000);
        } else {
            activeDrag.style.transition = "all 0.5s"; activeDrag.style.top = '72%';
            activeDrag.style.left = (Math.random() * 70 + 5) + '%';
        }
        activeDrag = null;
    }

    function levelUp() {
        level++; score = 0;
        document.getElementById('match-side').innerHTML = '';
        document.getElementById('words-container').innerHTML = '';
        activeWords = [];
        animals.push({emoji: animalList[Math.floor(Math.random() * animalList.length)], pos: Math.random() * 80});
        updateHUD();
    }

    function updateHUD() {
        document.getElementById('lvl').innerText = level;
        document.getElementById('count').innerText = animals.length;
        document.getElementById('score').innerText = score;
        const layer = document.getElementById('animal-layer');
        layer.innerHTML = '';
        animals.forEach((ani, i) => {
            const a = document.createElement('div');
            a.className = 'animal'; a.id = 'ani-'+i; a.innerText = ani.emoji;
            a.style.left = ani.pos + '%'; layer.appendChild(a);
        });
    }

    setInterval(() => {
        animals.forEach((ani, i) => {
            let move = (Math.random() * 20) - 10;
            ani.pos = Math.max(5, Math.min(85, ani.pos + move));
            const el = document.getElementById('ani-' + i);
            if (el) { el.style.left = ani.pos + '%'; el.style.transform = move > 0 ? 'scaleX(1)' : 'scaleX(-1)'; }
        });
    }, 3500);

    updateHUD();
</script>
</body>
</html>
